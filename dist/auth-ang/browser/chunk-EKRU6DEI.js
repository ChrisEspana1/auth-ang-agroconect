import{a as j}from"./chunk-4K65YOP6.js";import{a as V}from"./chunk-6EL4LVNF.js";import{f as A,i as w,n as F,o as D,p as T,s as N}from"./chunk-MCBS46X7.js";import{Ba as p,Ea as P,Ja as u,Ua as l,Va as r,Vb as k,Wa as n,Xa as v,Z as _,Zb as y,_ as f,bb as C,db as g,fb as S,fc as E,tb as c,ua as a,vb as I,wb as b,xb as M,yb as O,zb as x}from"./chunk-T52MBMFP.js";import"./chunk-RA2WU32H.js";function W(s,i){if(s&1){let d=C();r(0,"li"),c(1),r(2,"button",5),g("click",function(){let t=_(d).$implicit,o=S();return f(o.eliminarAsignacion(t.curso_proveedor_id))}),c(3,"Eliminar asignaci\xF3n"),n()()}if(s&2){let d=i.$implicit;a(),b(" ",d.nombre," - ",d.servicio,`
`)}}function L(s,i){if(s&1&&(r(0,"option",2),c(1),n()),s&2){let d=i.$implicit;l("value",d.id),a(),b(" ",d.nombre," - ",d.servicio," ")}}var K=(()=>{let i=class i{constructor(e,t,o){this.route=e,this.cursoService=t,this.proveedoresService=o,this.proveedoresAsignados=[],this.proveedoresDisponibles=[],this.proveedorSeleccionadoId=null}ngOnInit(){this.cursoId=this.route.snapshot.paramMap.get("id"),this.cargarCurso(),this.cursoService.getProveedoresPorCurso(this.cursoId).subscribe({next:e=>{this.proveedoresAsignados=e,this.cargarProveedoresDisponibles()},error:e=>console.error("Error al cargar proveedores asignados, ",e)})}cargarCurso(){this.cursoService.getCursoPorId(this.cursoId).subscribe({next:e=>this.cursoNombre=e.titulo,error:e=>console.error("Error al obtener el curso",e)})}cargarProveedoresAsignados(){this.proveedoresService.getProveedoresPorCurso(this.cursoId).subscribe({next:e=>this.proveedoresAsignados=e,error:e=>console.error("Error al cargar proveedores asignados",e)})}cargarProveedoresDisponibles(){this.proveedoresService.getTodosLosProveedores().subscribe({next:e=>{let t=this.proveedoresAsignados.map(o=>o.id);this.proveedoresDisponibles=e.filter(o=>!t.includes(o.id))},error:e=>console.error("Error al cargar proveedores disponibles",e)})}asignarProveedor(){this.proveedorSeleccionadoId&&this.cursoService.asignarProveedorACurso(this.cursoId,this.proveedorSeleccionadoId).subscribe({next:()=>{alert("Proveedor asignado correctamente"),this.proveedorSeleccionadoId=null,this.cargarProveedoresAsignados(),this.cargarProveedoresDisponibles(),this.ngOnInit()},error:()=>alert("Error al asignar proveedor al curso, ya existe una asignaci\xF3n")})}eliminarAsignacion(e){this.ngOnInit(),this.cursoService.eliminarAsignacionPorId(e).subscribe({next:()=>{alert("Asignaci\xF3n eliminada"),this.cargarProveedoresAsignados(),this.cargarProveedoresDisponibles(),this.ngOnInit()},error:()=>alert("Error al eliminar asignaci\xF3n")})}volverEdicionCurso(){window.history.back()}};i.\u0275fac=function(t){return new(t||i)(p(E),p(V),p(j))},i.\u0275cmp=P({type:i,selectors:[["app-providers"]],decls:16,vars:6,consts:[[4,"ngFor","ngForOf"],[3,"ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[3,"click","disabled"],[3,"click"]],template:function(t,o){t&1&&(r(0,"h2"),c(1),n(),r(2,"ul"),u(3,W,4,2,"li",0),n(),v(4,"hr"),r(5,"h3"),c(6,"Asignar nuevo proveedor"),n(),r(7,"select",1),x("ngModelChange",function(m){return O(o.proveedorSeleccionadoId,m)||(o.proveedorSeleccionadoId=m),m}),r(8,"option",2),c(9,"-- Selecciona un proveedor --"),n(),u(10,L,2,3,"option",3),n(),r(11,"button",4),g("click",function(){return o.asignarProveedor()}),c(12,"Asignar"),n(),v(13,"hr"),r(14,"button",5),g("click",function(){return o.volverEdicionCurso()}),c(15,"Volver"),n()),t&2&&(a(),I("Proveedores asignados a ",o.cursoNombre),a(2),l("ngForOf",o.proveedoresAsignados),a(4),M("ngModel",o.proveedorSeleccionadoId),a(),l("value",null),a(2),l("ngForOf",o.proveedoresDisponibles),a(),l("disabled",!o.proveedorSeleccionadoId))},dependencies:[y,k,N,D,T,F,A,w],styles:["h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{color:#725c3a;margin-bottom:1rem}ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin-bottom:2rem}li[_ngcontent-%COMP%]{background-color:#d2a880;padding:.75rem 1rem;margin-bottom:.5rem;border-radius:6px;color:#333;display:flex;justify-content:space-between;align-items:center;transition:background-color .3s ease}li[_ngcontent-%COMP%]:hover{background-color:#809671;color:#fff}li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#838792;color:#fff;border:none;padding:.4rem .8rem;border-radius:4px;cursor:pointer;transition:background-color .3s ease}li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#725c3a}select[_ngcontent-%COMP%]{width:100%;padding:.5rem;margin-bottom:1rem;border:1px solid #838792;border-radius:4px;background-color:#fff;color:#333}button[_ngcontent-%COMP%]{background-color:#809671;color:#fff;padding:.6rem 1.2rem;border:none;border-radius:4px;cursor:pointer;font-weight:700;transition:background-color .3s ease;margin-top:.5rem}button[_ngcontent-%COMP%]:hover{background-color:#725c3a}button[_ngcontent-%COMP%]:disabled{background-color:#a9b89a;cursor:not-allowed}hr[_ngcontent-%COMP%]{border:none;border-top:1px solid #e5d2bb;margin:2rem 0}"]});let s=i;return s})();export{K as ProvidersComponent};
